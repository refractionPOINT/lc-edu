<htmL>
    <head>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <div class="container">
         
            <iframe width="670" height="377" src="https://www.youtube.com/embed/j40UQKulfos" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            
            <h2>Policies</h2>

            <p>Policies govern the access as well as the configuration of various other tools used by lc-net. Generally policies will apply either to all lc-net endpoints or lc-net endpoints with a given tag applied to them.</p>

            <p>Operations on policies are generic and the specific configuration is dependant on the policy type itself.</p>

            <p>Policies can be set using the CLI like this:</p>

            <script src="https://gist.github.com/tekgrunt/ce18ae762b8acfd632abe962d4d7ccb2.js"></script>

            <p>Policies often contain some generic components:</p>

            <p><code>bpf_filter:</code> this is a tcpdump-like BPF filter syntax describing matching packets. An empty bpf_filter will match all traffic.</p>

            <p><code>times:</code> this is a list of Time Descriptors that describe when this policy is valid and applied. If any of the Time Descriptor is valid, the policy will be applied. More details in the Time Descriptor section below.</p>

            <p><code>sources:</code> this is a list of networks in CIDR notations where the clients must be connecting from for the policy to apply.</p>

            <h2>Time Descriptor</h2>

            <p>A Time Descriptor is a block of configuration that describes a period of time. This can be done in a few different ways. These different ways can be combined together.</p>

            <h3>Time Zone</h3>

            <p>The Time Zone specified should match a <code>TZ database</code> name of the <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank">Time Zones Database</a>.</p>

            <h3>Epoch Times</h3>

            <p>Specify second epoch timestamps by specifying <code>ts_start</code> and <code>ts_end</code>.</p>

            <h3>Time of Day</h3>

            <p>Using a time of day by specifying <code>time_of_day_start</code> and <code>time_of_day_end</code>. Each of these parameters is an integer representing the 24h time and minute. For example for 16h30m specify <code>1630</code>.</p>

            <h3>Day of Week</h3>

            <p>Using a day of the week range by specifying <code>day_of_week_start</code> and <code>day_of_week_end</code> where the value is the integer representing the day of the week starting with Sunday equal to <code>1</code>. So for example, Tuesday is <code>3</code>.</p>

            <h3>Day of Month</h3>

            <p>Using a specific day of the week by specifying <code>day_of_month</code> where the value is the integer representing the day of the month, from <code>1</code> to <code>31</code>.</p>

            <h3>Month of year</h3>

            <p>Using a specific month of the year by specifying <code>month_of_year</code> where the value is the integer representing the month, where January is <code>1</code> and December is <code>12</code>.</p>

            <h3>Example</h3>

            <p>Let's say you want a policy to be valid from 8 AM to 6 PM, Mondays in the Pacific Time Zone:</p>

            <script src="https://gist.github.com/tekgrunt/4b39b9cf7d839e0b9e1d71c571b7651e.js"></script>

            <h2>Troubleshooting</h2>

            <p>It is sometimes useful to see the list of policies that currently apply to a given sensor. To do this you may use one of the following:</p>

            <ul>
                <li>REST endpoint: <code>/net/policy/applicable/SID</code></li>

                <li>Python CLI: <code>limacharlie net client policies --help</code></li>

                <li>Python SDK: <code>function getApplicablePolicies(sid) of the class limacharlie.Net</code></li>
            </ul>


            
            <h3>Service</h3>

            <p>Service policies define a service available through the network on a specific host, and which other endpoints have access to it.</p>

            <p>The <code>server_sid</code> specifies the Sensor ID of the lc-net endpoint running the service. The <code>service_port</code> defines a specific port (or<code> 0</code> for any) where the service is running.<p>

            <p>The <code>tag_clients</code> specifies a tag that defines which lc-net endpoints have access to this service.</p>

            <p>The <code>protocol</code> defines the network protocol ID that the service is allowed on. TCP is <code>6</code> and UDP is <code>17</code>.</p>

            <p>The following example describes that all lc-net endpoints with the <code>finance</code> tag should be allowed to connect to the service running on TCP port 8000 for the Sensor ID <code>9ccd5a2c-e83c-4ffb-8f52-9f48626a6fc6</code>.</p>

            <p>Once in place, accessing this service can be done using the server's Internal IP that is available through the detailed information view of a given sensor. In the case of lc-net endpoints, this Internal IP is always in the <code>10.x.x.x</code> range and is static, meaning a sensor is given an Internal IP that it will keep for its whole lifetime, making it easier to bookmark services or even create your own DNS entries for services.</p>

            <p>Sample policy:</p>

            <script src="https://gist.github.com/tekgrunt/64828e2b307982dde37fde50af015737.js"></script>

            <h3>Service</h3>

            <p>Service policies define a service available through the network on a specific host, and which other endpoints have access to it.</p>

            <p>The server_sid specifies the Sensor ID of the lc-net endpoint running the service. The service_port defines a specific port (or 0 for any) where the service is running.</p>

            <p>The tag_clients specifies a tag that defines which lc-net endpoints have access to this service.</p>

            <p>The protocol defines the network protocol ID that the service is allowed on. TCP is 6 and UDP is 17.</p>

            <p>The following example describes that all lc-net endpoints with the finance tag should be allowed to connect to the service running on TCP port 8000 for the Sensor ID 9ccd5a2c-e83c-4ffb-8f52-9f48626a6fc6.

            Once in place, accessing this service can be done using the server's Internal IP that is available through the detailed information view of a given sensor. In the case of lc-net endpoints, this Internal IP is always in the 10.x.x.x range and is static, meaning a sensor is given an Internal IP that it will keep for its whole lifetime, making it easier to bookmark services or even create your own DNS entries for services.

            Sample policy:

        </div>
    </body>
</htmL>